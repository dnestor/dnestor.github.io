<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>Dana Nestor's Blog: Text as Data Post 4</title>

<meta property="description" itemprop="description" content="Further processing and data exploration"/>

<link rel="canonical" href="https://dnestor.github.io/posts/2022-03-27-text-as-data-post-4/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2022-03-27"/>
<meta property="article:created" itemprop="dateCreated" content="2022-03-27"/>
<meta name="article:author" content="Dana Nestor"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Dana Nestor&#39;s Blog: Text as Data Post 4"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Further processing and data exploration"/>
<meta property="og:url" content="https://dnestor.github.io/posts/2022-03-27-text-as-data-post-4/"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Dana Nestor&#39;s Blog"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="Dana Nestor&#39;s Blog: Text as Data Post 4"/>
<meta property="twitter:description" content="Further processing and data exploration"/>
<meta property="twitter:url" content="https://dnestor.github.io/posts/2022-03-27-text-as-data-post-4/"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Dana Nestor&#39;s Blog: Text as Data Post 4"/>
<meta name="citation_fulltext_html_url" content="https://dnestor.github.io/posts/2022-03-27-text-as-data-post-4/"/>
<meta name="citation_online_date" content="2022/03/27"/>
<meta name="citation_publication_date" content="2022/03/27"/>
<meta name="citation_author" content="Dana Nestor"/>
<meta name="citation_author_institution" content="UMASS DACSS"/>
<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","categories","draft","output","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Text as Data Post 4"]},{"type":"character","attributes":{},"value":["Further processing and data exploration"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Dana Nestor"]},{"type":"character","attributes":{},"value":["https://dnestor.github.io/"]},{"type":"character","attributes":{},"value":["UMASS DACSS"]},{"type":"character","attributes":{},"value":["https://www.umass.edu/sbs/data-analytics-and-computational-social-science-program/about"]}]}]},{"type":"character","attributes":{},"value":["2022-03-27"]},{"type":"character","attributes":{},"value":["Text as Data","Data exploration","Pre-processing"]},{"type":"logical","attributes":{},"value":[false]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","code_folding","toc","toc_depth"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[4]}]}]},{"type":"character","attributes":{},"value":["https://dnestor.github.io/posts/2022-03-27-text-as-data-post-4/"]},{"type":"character","attributes":{},"value":["https://dnestor.github.io/posts/2022-03-27-text-as-data-post-4/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["2012 Employment Law Year In Review _ Fisher Phillips_files/analytics.js","2012 Employment Law Year In Review _ Fisher Phillips_files/detectizr.min.js","2012 Employment Law Year In Review _ Fisher Phillips_files/download.svg","2012 Employment Law Year In Review _ Fisher Phillips_files/gtm.js","2012 Employment Law Year In Review _ Fisher Phillips_files/meneghello-rich.jpg","2012 Employment Law Year In Review _ Fisher Phillips_files/modernizr-custom.js","2012 Employment Law Year In Review _ Fisher Phillips_files/publication.css","2012 Employment Law Year In Review _ Fisher Phillips_files/publication.js","2012 Employment Law Year In Review _ Fisher Phillips_files/vendor.bundle.js","2012 Employment Law Year In Review _ Fisher Phillips.html","2012 Employment Law Year In Review _ Fisher Phillips.pdf","art_distro_plot_2.png","art_distro_plot.png","big_contract_frame.csv","corpus_docs.csv","text-as-data-post-4_files/anchor-4.2.2/anchor.min.js","text-as-data-post-4_files/bowser-1.9.3/bowser.min.js","text-as-data-post-4_files/distill-2.2.21/template.v2.js","text-as-data-post-4_files/header-attrs-2.13/header-attrs.js","text-as-data-post-4_files/jquery-3.6.0/jquery-3.6.0.js","text-as-data-post-4_files/jquery-3.6.0/jquery-3.6.0.min.js","text-as-data-post-4_files/jquery-3.6.0/jquery-3.6.0.min.map","text-as-data-post-4_files/kePrint-0.0.1/kePrint.js","text-as-data-post-4_files/lightable-0.0.1/lightable.css","text-as-data-post-4_files/popper-2.6.0/popper.min.js","text-as-data-post-4_files/tippy-6.2.7/tippy-bundle.umd.min.js","text-as-data-post-4_files/tippy-6.2.7/tippy-light-border.css","text-as-data-post-4_files/tippy-6.2.7/tippy.css","text-as-data-post-4_files/tippy-6.2.7/tippy.umd.min.js","text-as-data-post-4_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        return "<p>" + $('#ref-' + ref).html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */
@import url('https://fonts.googleapis.com/css2?family=Cardo');
@import url('https://fonts.googleapis.com/css2?family=Alata');


html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.075rem;                   /* edited */
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --heading-color:   rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    'Alata', sans-serif;        /* edited */
  --mono-font:       monospace;
  --body-font:       'Cardo', serif;             /* edited */
  --navbar-font:     'Alata', sans-serif;        /* edited */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       1.075rem;                   /* edited */
  --text-color:      rgb(0, 0, 0);               /* edited */
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       #000;                     /* edited */
  --text-size:        15px;
  --hover-color:      #ff00ff;                  /* edited */
  --bkgd-color:       #fff;                     /* edited */
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/

.categories li > a:hover {
    color: #00ff00;
    border-bottom: 1px #00ff00;
}

p a:hover  {
    color: #00ff00;
}

/* Change appearance of headers */
h1, h2, h3, h4, h5 {
    font-weight: 700;
}

/* Use specific font in the body of the text */
html, body, p {
    font-weight: 200;
    /*line-height: 1.3rem; */
    /*font-style: normal;*/
}

ul > li::marker {
    font-weight: 700;
    font-size: 1.125em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.13/header-attrs.js"></script>
  <script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Text as Data Post 4","description":"Further processing and data exploration","authors":[{"author":"Dana Nestor","authorURL":"https://dnestor.github.io/","affiliation":"UMASS DACSS","affiliationURL":"https://www.umass.edu/sbs/data-analytics-and-computational-social-science-program/about","orcidID":""}],"publishedDate":"2022-03-27T00:00:00.000-04:00","citationText":"Nestor, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">Dana Nestor's Blog</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../about.html">About</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Text as Data Post 4</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../index.html#category:Text_as_Data" class="dt-tag">Text as Data</a>
  <a href="../../index.html#category:Data_exploration" class="dt-tag">Data exploration</a>
  <a href="../../index.html#category:Pre-processing" class="dt-tag">Pre-processing</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>Further processing and data exploration</p></p>
</div>

<div class="d-byline">
  Dana Nestor <a href="https://dnestor.github.io/" class="uri">https://dnestor.github.io/</a> (UMASS DACSS)<a href="https://www.umass.edu/sbs/data-analytics-and-computational-social-science-program/about" class="uri">https://www.umass.edu/sbs/data-analytics-and-computational-social-science-program/about</a>
  
<br/>2022-03-27
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#fixes-from-last-post">Fixes from Last Post</a></li>
<li><a href="#subset-by-article">Subset by Article</a>
<ul>
<li><a href="#kwic-exploration---table-of-contents">KWIC Exploration - Table of Contents</a></li>
<li><a href="#kwic-exploration---article">KWIC Exploration - Article</a></li>
<li><a href="#aside">Aside</a></li>
</ul></li>
<li><a href="#similarity-betweeen-contracts-of-same-employer">Similarity Betweeen Contracts of Same Employer</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</nav>
</div>
<p>Files for everything done below can be found on <a href="https://github.com/dnestor/dnestor.github.io/tree/main/docs/_posts/2022-03-27-text-as-data-post-4">GitHub</a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>echo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://yihui.org/knitr/'>knitr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://docs.ropensci.org/pdftools/'>pdftools</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://stringr.tidyverse.org'>stringr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://quanteda.io'>quanteda</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>quanteda.textplots</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://lubridate.tidyverse.org'>lubridate</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://haozhu233.github.io/kableExtra/'>kableExtra</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/markvanderloo/stringdist'>stringdist</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="fixes-from-last-post">Fixes from Last Post</h3>
<p>needed to recreate larger frame, code below does this, not significantly different than earlier posts, included for context if interested</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Import info on files to be used</span>
<span class='va'>corpus_docs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span>
  <span class='st'>"/Users/dananestor/DACSS/Blog/Untitled/docs/_posts/2022-03-27-text-as-data-post-4/corpus_docs.csv"</span>, 
  show_col_types <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>corpus_files</span> <span class='op'>&lt;-</span> <span class='va'>corpus_docs</span><span class='op'>$</span><span class='va'>File</span>
<span class='va'>corpus_file_names</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>corpus_docs</span><span class='op'>$</span><span class='va'>Name</span><span class='op'>)</span>
<span class='va'>clean_contracts_table</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span>
  <span class='st'>"/Users/dananestor/DACSS/Blog/Untitled/docs/_posts/2022-03-06-text-as-data-post-3/clean_contracts_table.csv"</span>,
  show_col_types <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'># Create new contract frame</span>
<span class='va'>big_contract_frame</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='st'>"a"</span>,<span class='st'>"b"</span>,<span class='st'>"c"</span><span class='op'>)</span> <span class='co'>#create empty data frame </span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>big_contract_frame</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"contract"</span>, <span class='st'>"text"</span>, <span class='st'>"pages"</span><span class='op'>)</span>

<span class='co'># Loop for adding contract number, document text, and page numbers</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>corpus_files</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
<span class='co'>#  print(i)</span>
  <span class='va'>big_contract_frame</span><span class='op'>[</span><span class='va'>i</span>,<span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>corpus_file_names</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>
  <span class='va'>big_contract_frame</span><span class='op'>[</span><span class='va'>i</span>,<span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> 
    <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span>
      <span class='fu'><a href='https://rdrr.io/r/base/message.html'>suppressMessages</a></span><span class='op'>(</span><span class='fu'><a href='https://docs.ropensci.org/pdftools/reference/pdftools.html'>pdf_text</a></span><span class='op'>(</span>
        <span class='va'>corpus_files</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>, 
    sep <span class='op'>=</span> <span class='st'>''</span>, collapse <span class='op'>=</span> <span class='st'>''</span><span class='op'>)</span>
  <span class='va'>big_contract_frame</span><span class='op'>[</span><span class='va'>i</span>,<span class='fl'>3</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://docs.ropensci.org/pdftools/reference/pdftools.html'>pdf_info</a></span><span class='op'>(</span><span class='va'>corpus_files</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span><span class='op'>$</span><span class='va'>pages</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Join w contracts table for metadata</span>
<span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>contract</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>contract</span><span class='op'>)</span> <span class='co'>#convert to integer for join </span>
<span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>pages</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>pages</span><span class='op'>)</span>

<span class='va'>big_contract_frame</span> <span class='op'>&lt;-</span> <span class='co'>#pull in meta-data using join</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>big_contract_frame</span>, 
            <span class='va'>clean_contracts_table</span>, 
            by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"contract"</span> <span class='op'>=</span> <span class='st'>"CBA.File"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>contract</span>, <span class='va'>Employer.Name</span>, <span class='va'>Union</span>, <span class='va'>Location</span>, <span class='va'>Expiration.Date</span>, <span class='va'>NAICS.</span>, <span class='va'>X.Wrkrs</span>, <span class='va'>pages</span>, <span class='va'>text</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Clean up regions</span>
<span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>Loc_unique</span> <span class='op'>&lt;-</span> <span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>Location</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='co'>#clean up location names</span>
  <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='st'>"OHIO"</span>, <span class='st'>"OH"</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='st'>"FORT HILL, OK"</span>, <span class='st'>"OK"</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='st'>"PASCAGONOULA, MISSISSIPPI"</span>, <span class='st'>"MS"</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='st'>"PASCAGOULA"</span>, <span class='st'>"MS"</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='st'>"U.S."</span>, <span class='st'>"NATIONAL"</span><span class='op'>)</span>  <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='st'>"(..).+"</span>, <span class='st'>'\\1'</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='st'>"NA"</span>, <span class='st'>"NATIONAL"</span><span class='op'>)</span>

<span class='va'>regions</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span> <span class='co'>#pull in census data on regions</span>
  <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>'/Users/dananestor/DACSS/Useful Data/us census bureau regions and divisions.csv'</span>, 
           show_col_types <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"NATIONAL"</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>Region</span> <span class='op'>&lt;-</span> <span class='va'>regions</span><span class='op'>$</span><span class='va'>Region</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span><span class='op'>(</span> <span class='co'>#add region column using census data</span>
                            <span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>Loc_unique</span>,
                            <span class='va'>regions</span><span class='op'>$</span><span class='va'>`State Code`</span><span class='op'>)</span><span class='op'>]</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='st'>"NATIONAL"</span>, <span class='st'>"National"</span><span class='op'>)</span>

<span class='co'># Clean up industry</span>
<span class='va'>NAICS_short</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span> <span class='co'>#pull in census data on industry</span>
                  <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"/Users/dananestor/DACSS/Useful Data/NAICS_2_digits.csv"</span>,
                            show_col_types <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>NAICS</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span>
                  <span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"/Users/dananestor/DACSS/Useful Data/NAICS_complete.csv"</span>, 
                            show_col_types <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>Industry</span> <span class='op'>&lt;-</span> <span class='va'>NAICS</span><span class='op'>$</span><span class='va'>industry_title</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span><span class='op'>(</span> <span class='co'>#add specific industry info</span>
                            <span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>NAICS.</span>,
                            <span class='va'>NAICS</span><span class='op'>$</span><span class='va'>industry_code</span><span class='op'>)</span><span class='op'>]</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='st'>"NAICS\\s\\d+\\s(.+)"</span>, <span class='st'>"\\1"</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='st'>"NAICS\\d+\\s\\d+\\s(.+)"</span>, <span class='st'>"\\1"</span><span class='op'>)</span>

<span class='va'>big_contract_frame</span> <span class='op'>&lt;-</span> <span class='va'>big_contract_frame</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='co'>#add general industry info</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='st'>"Short_Industry"</span> <span class='op'>=</span>
           <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substr</a></span><span class='op'>(</span><span class='va'>NAICS.</span>, <span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>Short_Industry</span> <span class='op'>&lt;-</span> <span class='va'>NAICS_short</span><span class='op'>$</span><span class='va'>Definition</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span><span class='op'>(</span>
                                    <span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>Short_Industry</span>,
                                    <span class='va'>NAICS_short</span><span class='op'>$</span><span class='va'>Sector</span><span class='op'>)</span><span class='op'>]</span>

<span class='co'># Reorder columns</span>
<span class='va'>big_contract_frame</span> <span class='op'>&lt;-</span> <span class='va'>big_contract_frame</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>contract</span>, <span class='va'>Employer.Name</span>, <span class='va'>Union</span>, <span class='va'>Location</span>, <span class='va'>Loc_unique</span>, <span class='va'>Region</span>, <span class='va'>Expiration.Date</span>, 
      <span class='va'>NAICS.</span>, <span class='va'>Industry</span>, <span class='va'>Short_Industry</span>, <span class='va'>X.Wrkrs</span>, <span class='va'>pages</span>, <span class='va'>text</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='co'># Save</span>
<span class='fu'><a href='https://readr.tidyverse.org/reference/write_delim.html'>write_csv</a></span><span class='op'>(</span><span class='va'>big_contract_frame</span>, 
          <span class='st'>"/Users/dananestor/DACSS/Blog/Untitled/docs/_posts/2022-03-27-text-as-data-post-4/big_contract_frame.csv"</span><span class='op'>)</span>

<span class='va'>big_contract_frame</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice_head</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_trunc.html'>str_trunc</a></span><span class='op'>(</span><span class='va'>text</span>, 
                          width <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span>caption <span class='op'>=</span> <span class='st'>'Larger Corpus Data Frame'</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://rdrr.io/pkg/kableExtra/man/kable_styling.html'>kable_styling</a></span><span class='op'>(</span>bootstrap_options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"striped"</span>, 
                                      <span class='st'>"hover"</span>, 
                                      <span class='st'>"responsive"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://rdrr.io/pkg/kableExtra/man/scroll_box.html'>scroll_box</a></span><span class='op'>(</span>width <span class='op'>=</span> <span class='st'>"100%"</span><span class='op'>)</span>
</code></pre>
</div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:larger-frame">Table 1: </span>Larger Corpus Data Frame
</caption>
<thead>
<tr>
<th style="text-align:right;">
contract
</th>
<th style="text-align:left;">
Employer.Name
</th>
<th style="text-align:left;">
Union
</th>
<th style="text-align:left;">
Location
</th>
<th style="text-align:left;">
Loc_unique
</th>
<th style="text-align:left;">
Region
</th>
<th style="text-align:left;">
Expiration.Date
</th>
<th style="text-align:right;">
NAICS.
</th>
<th style="text-align:left;">
Industry
</th>
<th style="text-align:left;">
Short_Industry
</th>
<th style="text-align:right;">
X.Wrkrs
</th>
<th style="text-align:right;">
pages
</th>
<th style="text-align:left;">
text
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
WEYERHAEUSER PAPER COMPANY
</td>
<td style="text-align:left;">
PULP AND PAPER WORKERS UBCJA (WPPW) LOCAL UNION 211/PULP AND PAPER WORKERS UBCJA (WPPW) LOCAL UNION 580/PULP AND PAPER WORKERS UBCJA (WPPW) LOCAL UNION 633/PULP AND PAPER WORKERS UBCJA (WPPW) LOCAL UNION 677
</td>
<td style="text-align:left;">
NATIONAL
</td>
<td style="text-align:left;">
NATIONAL
</td>
<td style="text-align:left;">
National
</td>
<td style="text-align:left;">
2001-03-04
</td>
<td style="text-align:right;">
321912
</td>
<td style="text-align:left;">
Cut stock, resawing lumber, and planing
</td>
<td style="text-align:left;">
Manufacturing
</td>
<td style="text-align:right;">
1300
</td>
<td style="text-align:right;">
204
</td>
<td style="text-align:left;">
Cornell University …
</td>
</tr>
<tr>
<td style="text-align:right;">
1015
</td>
<td style="text-align:left;">
SMACNA-WESTERN WASHINGTON, INC.
</td>
<td style="text-align:left;">
SMW 66
</td>
<td style="text-align:left;">
WA WESTERN
</td>
<td style="text-align:left;">
WA
</td>
<td style="text-align:left;">
West
</td>
<td style="text-align:left;">
2012-05-31
</td>
<td style="text-align:right;">
23822
</td>
<td style="text-align:left;">
Plumbing and HVAC contractors
</td>
<td style="text-align:left;">
Construction
</td>
<td style="text-align:right;">
3000
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:left;">
AGREEMENT By and Between Sheet Metal Work…
</td>
</tr>
<tr>
<td style="text-align:right;">
1016
</td>
<td style="text-align:left;">
SMACNA- WESTERN WASHINGTON, INC.
</td>
<td style="text-align:left;">
SMW 66
</td>
<td style="text-align:left;">
WA
</td>
<td style="text-align:left;">
WA
</td>
<td style="text-align:left;">
West
</td>
<td style="text-align:left;">
2009-05-31
</td>
<td style="text-align:right;">
23822
</td>
<td style="text-align:left;">
Plumbing and HVAC contractors
</td>
<td style="text-align:left;">
Construction
</td>
<td style="text-align:right;">
3000
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:left;">
STANDARD F…
</td>
</tr>
<tr>
<td style="text-align:right;">
1044
</td>
<td style="text-align:left;">
CONSTRUCTION CONTRACTORS ASSOCIATION OF HUDSON VALLEY (NON-RES)
</td>
<td style="text-align:left;">
UBC RC, UPSTATE NY
</td>
<td style="text-align:left;">
NY NEWBURGH
</td>
<td style="text-align:left;">
NY
</td>
<td style="text-align:left;">
Northeast
</td>
<td style="text-align:left;">
2006-05-31
</td>
<td style="text-align:right;">
23622
</td>
<td style="text-align:left;">
Commercial building construction
</td>
<td style="text-align:left;">
Construction
</td>
<td style="text-align:right;">
3000
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:left;">
K …
</td>
</tr>
<tr>
<td style="text-align:right;">
1050
</td>
<td style="text-align:left;">
URS FEDERAL SERVICES (AN AECOM COMPANY)
</td>
<td style="text-align:left;">
AIR ENGINEERING METAL TRADES COUNCIL
</td>
<td style="text-align:left;">
TN
</td>
<td style="text-align:left;">
TN
</td>
<td style="text-align:left;">
South
</td>
<td style="text-align:left;">
2020-06-30
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:left;">
<p>FA9101-18-R-1000</p>
<pre><code>           Exh... &lt;/td&gt;</code></pre>
</tr>
</tbody>
</table>
</div>
</div>
<h3 id="subset-by-article">Subset by Article</h3>
<p>Index big frame, comparable to corpus text names</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Index contract by position</span>
<span class='va'>big_contract_frame</span> <span class='op'>&lt;-</span> <span class='va'>big_contract_frame</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='st'>"Big_Text"</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>text</span><span class='op'>)</span>, 
         .before <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='co'># Save</span>
<span class='fu'><a href='https://readr.tidyverse.org/reference/write_delim.html'>write_csv</a></span><span class='op'>(</span><span class='va'>big_contract_frame</span>, 
          <span class='st'>"/Users/dananestor/DACSS/Blog/Untitled/docs/_posts/2022-03-27-text-as-data-post-4/big_contract_frame.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="kwic-exploration---table-of-contents">KWIC Exploration - Table of Contents</h4>
<p>Create corpus, use KWIC to explore</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Create corpus</span>
<span class='va'>big_contract_corpus</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/corpus.html'>corpus</a></span><span class='op'>(</span><span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>text</span><span class='op'>)</span>
<span class='va'>big_contract_corpus_summary</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>big_contract_corpus</span>, 
                                       n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span>

<span class='co'># Create KWIC for "Table of Contents"</span>
<span class='va'>kwic_toc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/kwic.html'>kwic</a></span><span class='op'>(</span><span class='va'>big_contract_corpus</span>, 
             <span class='fu'><a href='https://quanteda.io/reference/phrase.html'>phrase</a></span><span class='op'>(</span><span class='st'>"Table of Contents"</span><span class='op'>)</span>, 
             window <span class='op'>=</span> <span class='fl'>50</span>,
             case_insensitive <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># Capture contracts with detectable tables of contents</span>
<span class='va'>con_toc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>kwic_toc</span><span class='op'>$</span><span class='va'>docname</span><span class='op'>)</span>

<span class='co'># Visualize</span>
<span class='va'>kwic_toc_table</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='st'>"Contract"</span> <span class='op'>=</span> <span class='va'>kwic_toc</span><span class='op'>$</span><span class='va'>docname</span>, 
                         <span class='st'>"Keyword"</span> <span class='op'>=</span> <span class='va'>kwic_toc</span><span class='op'>$</span><span class='va'>keyword</span>, 
                         <span class='st'>"Context"</span> <span class='op'>=</span> <span class='va'>kwic_toc</span><span class='op'>$</span><span class='va'>post</span><span class='op'>)</span>

<span class='va'>kwic_toc_table</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Contract</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='co'>#get first two matches for each contract</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice_head</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='co'>#get first 5 documents</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice_head</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://rdrr.io/pkg/kableExtra/man/kable_styling.html'>kable_styling</a></span><span class='op'>(</span>bootstrap_options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"striped"</span>, 
                                      <span class='st'>"hover"</span>, 
                                      <span class='st'>"responsive"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<table class="table table-striped table-hover table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Contract
</th>
<th style="text-align:left;">
Keyword
</th>
<th style="text-align:left;">
Context
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:left;">
TABLE OF CONTENTS
</td>
<td style="text-align:left;">
Fa * * Summary Plan Description 158 Who Is Eligible . . . . . . . . 160 When Coverage Begins ; . . , . I62 How Benefits are Paid , 162 . Whatihe Deductible Is 163 What Charges Are Covered 163 What ” Usual and Customary or
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:left;">
TABLE OF CONTENTS
</td>
<td style="text-align:left;">
Page Summary of Benefits . - 184 How to Use Your Program 184 Estimate of Benefits 185 Explanation of Incentive Periods , . ’ 185 Payment Levels for Class I and Class II Benefits 185 Payment Levels for Class III Benefits 185 Program Maximum 185 Employee Eligibility ami Termination ’
</td>
</tr>
<tr>
<td style="text-align:left;">
text10
</td>
<td style="text-align:left;">
TABLE OF CONTENTS
</td>
<td style="text-align:left;">
Page Definitions 1 Purposes of this Agreement 3 Article 1 - Territory 4 Article 2 - Work Affected 4 Article 3 - Effective Date-Duration-Modification 6 ” No strike , no lockout ” provisions 6 Termination 7 Article 4 - Subcontractors Clause - Building 7 Non-signatory Subcontractors 7 Venders 8 Low
</td>
</tr>
<tr>
<td style="text-align:left;">
text10
</td>
<td style="text-align:left;">
Table of Contents
</td>
<td style="text-align:left;">
( Continued ) Article 5 - Union Recognition and Hiring ( continued ) Non-payment of Dues 19 Workers Qualifications 19 Separation Slips 19 Article 6 - Working Conditions 20 Hours of Work-Overtime 20 Single Shift - Heavy Highway 20 Single Shift - Building 20 Work Week 21 Federally Funded Work
</td>
</tr>
<tr>
<td style="text-align:left;">
text100
</td>
<td style="text-align:left;">
TABLE OF CONTENTS
</td>
<td style="text-align:left;">
MASTER AGREEMENT ARTICLE PAGE I Recognition 1 II Health and Welfare Benefits 1 III Retirement And Pension Benefits 6 IV Separation Benefit Allowance Plan 16 V Employee Stock Purchases Savings Plan . . . 18 VI Holidays 19 VII Vacations 22 VIII Leaves of Absence 28 IX Inter-Plant Transfer of
</td>
</tr>
<tr>
<td style="text-align:left;">
text101
</td>
<td style="text-align:left;">
TABLE OF CONTENTS
</td>
<td style="text-align:left;">
PAGE Aftnofi RECOGNITION 1 Afmcifz EMPLOYEE INVOLVEMENT 2 ARnci £ 3 GROUP UFE INSURANCE 2 3.1 . Eligibility , 3 3.2 . Benefits 3 3.3 . Contributions 3 3.4 . Retirement Coverage 3 3.4-1 . Normal Retirement 3 3.4-2 . Early Retirement 4 3.4-3 . Retirement After Normal Retirement Date
</td>
</tr>
<tr>
<td style="text-align:left;">
text101
</td>
<td style="text-align:left;">
TABLE OF CONTENTS
</td>
<td style="text-align:left;">
, CONT . PAGE ARTICLE n 11.2-4 . Death In Family 40 11.2-5 . In The Event Of Layoff 41 ARTICLE 12 GRIEVANCE PROCEDURE 41 12.1-1 . First Step 41 12.1-2 . Second Step 41 12.1-3 . Third Step 42 12.1-4 . Fourth Step 42 ARTICLED UNION SECURITY 45 ARTICLE
</td>
</tr>
<tr>
<td style="text-align:left;">
text109
</td>
<td style="text-align:left;">
TABLE OF CONTENTS
</td>
<td style="text-align:left;">
Page Assent Language I Basic Principles . I ARTICLE I SECTION 1.01 Effective Date 2 SECTION 1.02 Changes 2-3 SECTION 1.03 International IBEW / NECA Approval 3 SECTION 1.04 Work Stoppage 3 SECTION 1.05 Labor / Management Committee Matters 3 SECTION 1.06 Grievances 3 SECTION 1.07 Committee Matters 4 SECTION
</td>
</tr>
<tr>
<td style="text-align:left;">
text11
</td>
<td style="text-align:left;">
TABLE OF CONTENTS
</td>
<td style="text-align:left;">
Article and Section Page 1 PREAMBLE vii 2 PART A GENERAL AGREEMENT 1 3 ARTICLE I GENERAL CONDITIONS OF THE CONTRACT 1 4 Section 1 . - Application , Amendment , Modification and Termination of the Agreement 1 5 A . Recognition for Bargaining Unit 1 6 B . Definitions
</td>
</tr>
<tr>
<td style="text-align:left;">
text11
</td>
<td style="text-align:left;">
TABLE OF CONTENTS
</td>
<td style="text-align:left;">
Article and Section Page 1 Section 7 . - Information to be Furnished to the Union 17 2 A . Information to be Furnished Upon Request 17 3 B . Information to be Furnished on a Regular Basis 17 4 C . Reports on Computer Media 18 5 ARTICLE HI
</td>
</tr>
</tbody>
</table>
</div>
<p>Looks like “article” is the top-level unit on most contracts</p>
<h4 id="kwic-exploration---article">KWIC Exploration - Article</h4>
<p>What does it look like around article?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>kwic_art</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/kwic.html'>kwic</a></span><span class='op'>(</span><span class='fu'><a href='https://quanteda.io/reference/corpus_sample.html'>corpus_sample</a></span><span class='op'>(</span><span class='va'>big_contract_corpus</span>, size <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>,
             <span class='st'>"article"</span>, 
             window <span class='op'>=</span> <span class='fl'>30</span>,
             case_insensitive <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># Count</span>
<span class='va'>con_art</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>kwic_art</span><span class='op'>$</span><span class='va'>docname</span><span class='op'>)</span>

<span class='co'># Visualize</span>
<span class='va'>kwic_art_table</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='st'>"Contract"</span> <span class='op'>=</span> <span class='va'>kwic_art</span><span class='op'>$</span><span class='va'>docname</span>, 
                         <span class='st'>"Keyword"</span> <span class='op'>=</span> <span class='va'>kwic_art</span><span class='op'>$</span><span class='va'>keyword</span>, 
                         <span class='st'>"Pre"</span> <span class='op'>=</span> <span class='va'>kwic_art</span><span class='op'>$</span><span class='va'>pre</span>,
                         <span class='st'>"Post"</span> <span class='op'>=</span> <span class='va'>kwic_art</span><span class='op'>$</span><span class='va'>post</span><span class='op'>)</span>

<span class='va'>kwic_art_table</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Contract</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='co'>#get first two matches for each contract</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice_head</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='co'>#get first 5 documents</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice_head</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://rdrr.io/pkg/kableExtra/man/kable_styling.html'>kable_styling</a></span><span class='op'>(</span>bootstrap_options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"striped"</span>, 
                                      <span class='st'>"hover"</span>, 
                                      <span class='st'>"responsive"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<table class="table table-striped table-hover table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Contract
</th>
<th style="text-align:left;">
Keyword
</th>
<th style="text-align:left;">
Pre
</th>
<th style="text-align:left;">
Post
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:left;">
ARTICLE
</td>
<td style="text-align:left;">
, 1995 will receive such benefits , if any , as are provided in the Plan documents in effect on the date of their retirement , termination , or transfer
</td>
<td style="text-align:left;">
I . ELIGIBILITY AND SERVICE 1.1 The term ” Participant ” shall mean a person who was hired by Weyerhaeuser Company or an affiliated company ( ” Company ” )
</td>
</tr>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:left;">
ARTICLE
</td>
<td style="text-align:left;">
shall include salaried service , if any . Hours for nonperformance of duty shall be credited in accordance with DOL Regulation 2530.200b-2 ( b ) and ( c ) .
</td>
<td style="text-align:left;">
IA , SERVICE WITH OTHER COMPANIES 1A . 1 For all purposes of this Plan , service with a company designated , and for the period described in Schedule B
</td>
</tr>
<tr>
<td style="text-align:left;">
text105
</td>
<td style="text-align:left;">
Article
</td>
<td style="text-align:left;">
adjusting any difference by rational common sense methods . Now , therefore , in consideration of the mutual promise and agreements herein contained the parties hereto agree as follows :
</td>
<td style="text-align:left;">
I Effective Date - Changes - Grievances - Disputes Section 1.01 - Effective Date This agreement shall take effect September 1st , 2010 and shall remain in effect until August
</td>
</tr>
<tr>
<td style="text-align:left;">
text105
</td>
<td style="text-align:left;">
article
</td>
<td style="text-align:left;">
be specified in the notice , or not later than the first negotiating meeting unless mutually agreed otherwise . C ) The existing provisions of the agreement , including this
</td>
<td style="text-align:left;">
, shall remain in full force and effect until a conclusion is reached in the matter of proposed changes . 1 D ) Unresolved issues or disputes arising out of
</td>
</tr>
<tr>
<td style="text-align:left;">
text108
</td>
<td style="text-align:left;">
ARTICLE
</td>
<td style="text-align:left;">
. 3 . It is further agreed and understood that the liability of the Contractor subscribing hereto and the Local Union sub-scribing hereto shall be several and not joint .
</td>
<td style="text-align:left;">
I PURPOSE 4 . The purpose of this Agreement is to determine the hours , wages and other conditions of employment and to adopt measures for the settlement of differences
</td>
</tr>
<tr>
<td style="text-align:left;">
text108
</td>
<td style="text-align:left;">
ARTICLE
</td>
<td style="text-align:left;">
that the Contractors may secure sufficient capable employees and the employees may have as much continuous employment as possible without interruption by lockouts , strikes or other labor troubles .
</td>
<td style="text-align:left;">
II SCOPE OFAGREEMENT 5 . Highway / Heavy construction shall include construction , modification , additions or repairs of roads and streets and construction incidental thereto ; alleys , guardrails
</td>
</tr>
<tr>
<td style="text-align:left;">
text110
</td>
<td style="text-align:left;">
ARTICLE
</td>
<td style="text-align:left;">
Tires North America , Ltd . Buffalo , New York 9 l United Steelworkers of America I and Local #35I Expires 2006 b TABLE O F CONTENTS ) Page )
</td>
<td style="text-align:left;">
I - RECOGSITION SECTION 1.01 -BARGAINING UNIT SECTION 1.02 -UNION SECURITY ) ARTICLE I1 -UNION SECTION 2.01 -UNION FUNCTIONS ) SECTION 2.01 -UNION RESPONSIBILITY ) ARTICLE I l l -
</td>
</tr>
<tr>
<td style="text-align:left;">
text110
</td>
<td style="text-align:left;">
ARTICLE
</td>
<td style="text-align:left;">
Steelworkers of America I and Local #35I Expires 2006 b TABLE O F CONTENTS ) Page ) ARTICLE I - RECOGSITION SECTION 1.01 -BARGAINING UNIT SECTION 1.02 -UNION SECURITY )
</td>
<td style="text-align:left;">
I1 -UNION SECTION 2.01 -UNION FUNCTIONS ) SECTION 2.01 -UNION RESPONSIBILITY ) ARTICLE I l l - LIANACEMES1 - , - ARTIC1 . E IV BARGAINING PROCEDURE SECTION 4.01 -CllANGE
</td>
</tr>
<tr>
<td style="text-align:left;">
text112
</td>
<td style="text-align:left;">
ARTICLE
</td>
<td style="text-align:left;">
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . I
</td>
<td style="text-align:left;">
I . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
</td>
</tr>
<tr>
<td style="text-align:left;">
text112
</td>
<td style="text-align:left;">
ARTICLE
</td>
<td style="text-align:left;">
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
</td>
<td style="text-align:left;">
II . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
</td>
</tr>
</tbody>
</table>
</div>
<p>Use sample of 100 because full corpus is too large. Seems like a good place to start.</p>
<p>Out of 100 contracts sampled (so about 14% of the corpus), 88 have the word “article” in some form, with 7793 measured instances.</p>
<p>Good for increasing dimensionality in face of smaller-than-expected data set, allows for subtleties within each article to come through without being overwhelmed by words that appear in many articles, but infrequently in each.</p>
<p>Look at distro of “article” frequency across texts.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Count number of mentions of 'article' by document</span>
<span class='va'>art_distro</span> <span class='op'>&lt;-</span> <span class='va'>kwic_art</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>docname</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/count.html'>count</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>

<span class='co'># Plot distribution</span>
<span class='va'>art_distro_plot_2</span> <span class='op'>&lt;-</span> <span class='va'>art_distro</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='va'>docname</span>, <span class='va'>n</span><span class='op'>)</span>, <span class='co'>#order from least to most mentions</span>
               y <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_col</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>5</span>, <span class='co'>#mark baseline acceptable level</span>
             color <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Document"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_half_open</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        axis.ticks.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Frequency"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Number of 'Article' Mentions by Document"</span>, 
          <span class='st'>"Frequency of term in corpus sample"</span><span class='op'>)</span>

<span class='co'># Save</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"art_distro_plot_2.png"</span>, 
       <span class='va'>art_distro_plot_2</span>, 
       width <span class='op'>=</span> <span class='fl'>14</span>, 
       height <span class='op'>=</span> <span class='fl'>9</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><img src="art_distro_plot_2.png" /> Promising distro. Red line set at 5 instances of “article,” which seemed like a reasonable threshold - below, and contracts almost surely have some structural issue that should be explored.</p>
<h4 id="aside">Aside</h4>
<p>Found a very significant code error. Had to go back and fix most of the post. What you just read is correct now, but previously it looked very different. When examining the distro of “article” mentions across documents, found that many contracts only have one mention, which was inconsistent with the term being a top-level index.</p>
<figure>
<img src="art_distro_plot.png" alt="First plot of article mentions against number of contracts" /><figcaption aria-hidden="true">First plot of article mentions against number of contracts</figcaption>
</figure>
<p>To investigate further, created code below to inspect words around the term in docs with infrequent usage, with a hunch that this could be a different meaning of “article.”</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># NOT RUN</span>
<span class='co'># sum(art_distro$n_Docs[1:4]) #174 docs w/4 or fewer mentions of article</span>

<span class='co'># kwic_art_small &lt;- tibble("Contract" = kwic_art$docname, #create new tibble</span>
<span class='co'>#                         "Keyword" = kwic_art$keyword, </span>
<span class='co'>#                         "Pre" = kwic_art$pre,</span>
<span class='co'>#                         "Post" = kwic_art$post) %&gt;%</span>
<span class='co'>#                  add_count(kwic_art$docname) %&gt;% #count number of observations per text</span>
<span class='co'>#                  filter(n &lt;= 4) %&gt;% #filter for texts with 4 or fewer observations</span>
<span class='co'>#                  arrange(n, "Contract", .by_group = TRUE) #arrange in ascending order of number of observations</span>
</code></pre>
</div>
</div>
<p>Nothing in this data suggested an alternate usage of “Article” in our corpus at any significant level. On closer inspection, however, it appears that a number of these contracts have missing text - i.e. not as much text as we expected. After some testing, it becomes clear that we need to re-extract our text as somewhere along the way it was corrupted.</p>
<p>After looking through the code we originally used for this import, it appears that somewhere in our iterations we forgot to remove a subscript so each contract was only representative of the second page! Re-extracted text and re-ran previous functions.</p>
<p>Fixing the error led to major improvements in data quantity and quality:</p>
<ul>
<li><p>The number of documents with tables of contents went from 198 to 353</p></li>
<li><p>The number of instances of “article” detected went from 3,523 in 338 documents to a number so large that my computer ran out of memory when trying to process the kwic() function.</p></li>
<li><p>A sample of 100 contracts produced 7,793 matches, meaning that after the fix, 14% of the corpus produced over twice as many instances as before</p></li>
</ul>
<h3 id="similarity-betweeen-contracts-of-same-employer">Similarity Betweeen Contracts of Same Employer</h3>
<p>Substantial similarity between contracts from same employer? If so, remove so only one before and after to avoid over-weighting?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>big_contract_frame</span> <span class='op'>&lt;-</span> <span class='va'>big_contract_frame</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>Employer.Name</span><span class='op'>)</span>

<span class='va'>similarity_table</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='st'>"Contract"</span> <span class='op'>=</span> <span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>contract</span>, 
                           <span class='st'>"Company"</span> <span class='op'>=</span> <span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>Employer.Name</span>, 
                           <span class='st'>"Union"</span> <span class='op'>=</span> <span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>Union</span>, 
                           <span class='st'>"Date"</span> <span class='op'>=</span> <span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>Expiration.Date</span>, 
                           <span class='st'>"Similarity"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>text</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>text</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
<span class='co'>#  print(i)</span>
  <span class='va'>temp_1</span> <span class='op'>&lt;-</span> <span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>text</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>
  <span class='va'>temp_2</span> <span class='op'>&lt;-</span> <span class='va'>big_contract_frame</span><span class='op'>$</span><span class='va'>text</span><span class='op'>[</span><span class='va'>i</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>]</span>
  <span class='va'>temp_similar</span> <span class='op'>&lt;-</span> <span class='va'>temp_1</span><span class='op'>[</span><span class='va'>temp_1</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>temp_2</span><span class='op'>]</span>
  <span class='va'>similarity_table</span><span class='op'>[</span><span class='va'>i</span>,<span class='fl'>5</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>temp_similar</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>temp_1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>100</span>
<span class='op'>}</span>

<span class='va'>similarity_table_grouped</span> <span class='op'>&lt;-</span> <span class='va'>similarity_table</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Company</span><span class='op'>)</span> <span class='op'><a href='https://stringr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>&gt;=</span> <span class='fl'>2</span><span class='op'>)</span>

<span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice_head</a></span><span class='op'>(</span><span class='va'>similarity_table_grouped</span>,
           n <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 169 × 5
# Groups:   Company [74]
   Contract Company                   Union      Date       Similarity
      &lt;dbl&gt; &lt;chr&gt;                     &lt;chr&gt;      &lt;date&gt;          &lt;dbl&gt;
 1     1358 AGC, AK                   CARPENTER… 2011-06-30          0
 2     1663 AGC, AK                   LABORERS … 2012-06-30        100
 3     1664 AGC, AK                   LABORERS … 2012-06-30          0
 4     1237 AGC, CA - NORTHERN        ENGINEERS… 2006-06-15          0
 5     2137 AGC, CA - NORTHERN        LABORERS … 2019-06-30          0
 6     1700 AGC, CA (PILEDRIVERS)     UBC 34     NA                  0
 7     1705 AGC, CA (PILEDRIVERS)     UBC 34     2012-06-30          0
 8     1952 AGC, IN (SOUTHERN BRANCH) PLASTERER… 2017-04-30          0
 9     1953 AGC, IN (SOUTHERN BRANCH) PLASTERER… 2012-04-30          0
10     1242 AGC, MN (HVY-HWY-RR)      ENGINEERS… 2008-04-30          0
# … with 159 more rows</code></pre>
</div>
<p>100 appearing in a row means that the following row text is a 100% match. On examination, it appears that there is some pattern to this match, so there are likely duplicate contracts in our data set.</p>
<p>Very imperfect measure, only looking at similarity between adjacent contracts, looking at similarity as literal match of string. But still provides a simple way of seeing whether duplicate contracts exist or not. They do, but it will be difficult to make a meaningful decision b/c of inaccuracy of data, also we may want to keep for various reasons like article changes, etc. Definitely future area of exploration.</p>
<h3 id="conclusion">Conclusion</h3>
<p>Some interesting findings, were able to expand data in a hopefully meaningful way, corrected more code errors, lots more to do. Next post on cleaning strings, splitting by article, hopefully creating corpus/dfm.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Nestor (2022, March 27). Dana Nestor's Blog: Text as Data Post 4. Retrieved from https://dnestor.github.io/posts/2022-03-27-text-as-data-post-4/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{nestor2022text,
  author = {Nestor, Dana},
  title = {Dana Nestor's Blog: Text as Data Post 4},
  url = {https://dnestor.github.io/posts/2022-03-27-text-as-data-post-4/},
  year = {2022}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
